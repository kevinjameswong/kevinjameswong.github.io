---
title: "Kevin Wong - Music Data"
output:
  html_document:
    toc: yes
---

```{r echo = FALSE, warning = FALSE, message = FALSE}
Update_Date = as.Date("01-01-2025", format = "%m-%d-%Y")
#Update_Date

library(tidyverse)
library(dplyr)
library(lubridate)
library(knitr)
library(kableExtra)
library(tidyverse)
library(stringr)
library(ggplot2)
library(shiny)
```

<h1>Music Data</h1>

<p class="last-updated">
Last updated: `r paste(format(x = Update_Date, format = "%B"), " ", format(x = Update_Date, format = "%d") %>% as.numeric(), ", ", format(x = Update_Date, format = "%Y") %>% as.numeric(), sep = "")`
</p>

<hr />


```{r echo = FALSE, warning = FALSE, message = FALSE}
spotify = read.csv("~/Documents/KevinWebsite/kevinjameswong.github.io/files/SpotifyWrapped.csv")

spotify =
  spotify %>%
  select(Year,
         Ranking,
         Song,
         Album,
         Artist.1,
         Artist.2,
         Artist.3,
         Artist.4,
         Artist.5,
         Artist.6,
         Approx.Genre)

spotify = spotify %>%
  group_by(Year) %>%
  mutate(
    Score = max(row_number()) + 1 - row_number(),
    Count = 1,
    RecordInt = row_number()
  ) %>%
  filter(Song != "")


names(spotify) = c("Year", "Ranking", "Song", "Album", "Artist1", "Artist2", "Artist3", "Artist4", "Artist5", "Artist6", "Genre", "Score", "Count", "RecordInt")
```

```{r echo = FALSE}
AllArtists_AllYears = spotify %>%
  group_by(Artist1)   %>%
  summarize(xt = sum(Score),
            xt2 = n()) %>%
  rename("Score" = xt, "Artist" = Artist1, "TT" = xt2) %>%
  arrange(desc(Score))



```


```{r}
ui = fluidPage(
  "Hello, world!"
)
server = function(input, output, session) {
}
shinyApp(ui, server)
```

```{r echo = FALSE, eval = FALSE}
spotify %>% group_by(Song) %>% summarise(
  score = sum(Score)
)
```

```{r echo = FALSE, echo = FALSE, eval = FALSE}
spotify %>%
  group_by(Album)   %>%
  count(Album)      %>%
  rename(Count = n) %>%
  arrange(desc(Count))

names(groupby_yearmonth) = c("Month", "Total Runs", "Total Run Days", "Days Off", "Miles", "Time", "Pace", "Miles Per Run", "Miles Per Day", "Yearly Mile Rate", "MPH", "Total Calories Burned")

kable(x = groupby_yearmonth, format = "html", align = "lrrrrrrrrrrrrrr") %>%
  kable_styling(bootstrap_options = c("hover", "responsive")) %>%
  scroll_box(width = "100%", height = "100%")
```

```{r Most Popular Songs, echo = FALSE, eval = FALSE}
spotify %>%
  group_by(Song, Artist.1, Artist.2, Artist.3, Artist.4, Artist.5, Artist.6) %>%
  count(Song, Artist.1, Artist.2, Artist.3, Artist.4, Artist.5, Artist.6, Total = sum(Score)) %>%
  rename(Appearances = n) %>%
  arrange(desc(Total), desc(Appearances))
```

```{r Most Popular Artists, warning = FALSE, echo = FALSE, eval = FALSE}
a1 = spotify %>%
  count(Artist.1) %>%
  rename(Total = n, Artist = Artist.1)
a2 = spotify %>%
  count(Artist.2) %>%
  rename(Total = n, Artist = Artist.2)
a3 = spotify %>%
  count(Artist.3) %>%
  rename(Total = n, Artist = Artist.3)
a4 = spotify %>%
  count(Artist.4) %>%
  rename(Total = n, Artist = Artist.4)
a5 = spotify %>%
  count(Artist.5) %>%
  rename(Total = n, Artist = Artist.5)
a6 = spotify %>%
  count(Artist.6) %>%
  rename(Total = n, Artist = Artist.6)

bind_rows(a1, a2, a3, a4, a5, a6) %>%
  arrange(Artist) %>%
  group_by(Artist) %>%
  summarize(Total = sum(Total)) %>%
  arrange(desc(Total)) %>%
  tail(n = -1)
```


```{r Songs on 2016 and 2017, echo = FALSE, eval = FALSE}
spotify %>%
  filter(Year == 2016 | Year == 2017) %>%
  arrange(Song) %>%
  group_by(Song, Artist.1) %>%
  count(Song, Total = sum(Score)) %>%
  rename(Appearances = n) %>%
  filter(Appearances == 2) %>%
  arrange(desc(Total))
```

```{r Songs on 2017 and 2018, echo = FALSE, eval = FALSE}
spotify %>%
  filter(Year == 2017 | Year == 2018) %>%
  arrange(Song) %>%
  group_by(Song, Artist.1) %>%
  count(Song, Total = sum(Score)) %>%
  rename(Appearances = n) %>%
  filter(Appearances == 2) %>%
  arrange(desc(Total))
```

```{r Songs on 2016 and 2018, echo = FALSE, eval = FALSE}
spotify %>%
  filter(Year == 2016 | Year == 2018) %>%
  arrange(Song) %>%
  group_by(Song, Artist.1) %>%
  count(Song, Total = sum(Score)) %>%
  rename(Appearances = n) %>%
  filter(Appearances == 2) %>%
  arrange(desc(Total))
```








