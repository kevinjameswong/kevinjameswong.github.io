---
title: "Kevin Wong - Running Data"
output:
  html_document:
    toc: yes
---

```{r echo = FALSE, warning = FALSE, message = FALSE}
library(knitr)
library(kableExtra)
library(dplyr)
library(stringr)
Start_Date = as.Date("1/28/2018", format = "%m/%d/%Y")
```

```{r echo = FALSE}
Update_Date = as.Date("3/26/2019", format = "%m/%d/%Y")
```

***

```{r echo = FALSE}
read_data = read.csv("Running_03_26_2019.csv", skip = 1)

read_data = read_data[c(1:(Update_Date - Start_Date)-1), ]

running = read_data[, c(1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 14, 18, 19, 25)]

names(running) = c("Location", "Weekday_Read", "Month_Number_Read", "Day Number", "Date", "Run Calories", "Run Distance", "Run Minutes", "Run Seconds", "Walk Calories", "Walk Distance", "Walk Minutes", "Walk Seconds", "StartTime")

running$DayNumber    = running$`Day Number`    %>% as.character() %>% as.integer()
running$RunCalories  = running$`Run Calories`  %>% as.character() %>% as.integer()
running$RunDistance  = running$`Run Distance`  %>% as.character() %>% as.numeric()
running$RunMinutes   = running$`Run Minutes`   %>% as.character() %>% as.integer()
running$RunSeconds   = running$`Run Seconds`   %>% as.character() %>% as.integer()
running$WalkCalories = running$`Walk Calories` %>% as.character() %>% as.integer()
running$WalkDistance = running$`Walk Distance` %>% as.character() %>% as.numeric()
running$WalkMinutes  = running$`Walk Minutes`  %>% as.character() %>% as.integer()
running$WalkSeconds  = running$`Walk Seconds`  %>% as.character() %>% as.integer()
running = running[ , c(1, 2, 3, 5, 14:23)]

running$Month = factor(running$Month_Number_Read)
levels(running$Month) = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")

running$Year = as.factor(paste("20", (str_sub(running$Date, start = 7, end = 8)), sep = ""))

running$Weekday = factor(x = running$Weekday_Read,
                         levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))

running = select(running, - Weekday_Read, - Month_Number_Read)
```

<style type="text/css">

td {
   font-family: "Times New Roman";
   font-size: 20px;
}

body, p {
   font-family: "Times New Roman";
   font-size: 18px;
}

</style>

<h1>Kevin's Running Data</h1>

Last updated: `r paste(levels(running$Month)[str_extract(string = Update_Date, pattern = "-[0-9]{2}") %>% str_extract(pattern = "[0-9]{2}") %>% as.numeric()], " ", str_extract(string = Update_Date, pattern = "-[0-9]{2}-[0-9]{2}") %>% str_extract(pattern = "[0-9]{1}-[0-9]{2}") %>% str_extract(pattern = "[0-9]{2}"), ", ", str_extract(string = Update_Date, pattern = "[0-9]{4}"), sep = "")`

***

I am a enjoy running in my freetime! I have been tracking my jogging stats since January 31, 2018. Over the past `r length(running$RunDistance)` days, I have jogged `r sum(running$RunDistance)` miles across `r sum(running$RunDistance > 0)` different runs.

*** 

# Yearly Stats

```{r echo = FALSE}
groupby_year = running %>%
  group_by(Year) %>%
  summarise(Total_Runs = sum(RunDistance > 0),
            
            Distance = sum(RunDistance),
            
            Time = paste(ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60)),
                         
                         ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60)),
                         
                         ifelse(test = sum(RunSeconds) %% 60 <= 9,
                                yes = paste("0", sum(RunSeconds) %% 60, sep = ""),
                                no = as.character(sum(RunSeconds) %% 60)), sep = ":"),
            
            Pace = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %/% 60, ifelse(test = (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60 <= 9,
                          yes = paste("0", (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60, sep = ""),
                          no = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60)), sep = ":"))
            
            # Miles_Per_Run = floor(sum(RunDistance) * 100 / sum(RunDistance > 0)) / 100,
            
            #MPH = floor(sum(RunDistance) / (((((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60) * 60 * 60 + ((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60) * 60 + sum(RunSeconds) %% 60)) / (60 * 60)) * 1000) / 1000,
            
            #Calories = sum(RunCalories)
            #)

names(groupby_year) = c("Year", "Total Runs", "Miles", "Time", "Pace")#, "MPH", "Calories")

# names(groupby_weekday) = c("Weekday", "Total Runs", "Distance", "Time", "Pace", "Miles Per Run", "MPH", "Calories")

kable(groupby_year, format = "html", align = "l") %>%
  kable_styling(bootstrap_options = c("hover", "responsive"))
```

***

# Monthly Stats

```{r echo = FALSE}
groupby_yearmonth = running %>%
  group_by(Year, Month) %>%
  summarise(Total_Runs = sum(RunDistance > 0),
            
            Distance = sum(RunDistance),
            
            Time = paste(ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60)),
                         
                         ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60)),
                         
                         ifelse(test = sum(RunSeconds) %% 60 <= 9,
                                yes = paste("0", sum(RunSeconds) %% 60, sep = ""),
                                no = as.character(sum(RunSeconds) %% 60)), sep = ":"),
            
            Pace = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %/% 60, ifelse(test = (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60 <= 9,
                          yes = paste("0", (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60, sep = ""),
                          no = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60)), sep = ":"))
            
            # Miles_Per_Run = floor(sum(RunDistance) * 100 / sum(RunDistance > 0)) / 100,
            
            #MPH = floor(sum(RunDistance) / (((((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60) * 60 * 60 + ((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60) * 60 + sum(RunSeconds) %% 60)) / (60 * 60)) * 1000) / 1000,
            
            #Calories = sum(RunCalories)
            #)

groupby_yearmonth$yearmonth = paste(groupby_yearmonth$Month, groupby_yearmonth$Year, sep = " ")
groupby_yearmonth = select(as.data.frame(select(groupby_yearmonth, - Month)), - Year)
groupby_yearmonth = groupby_yearmonth[, c(5, 1:4)]
names(groupby_yearmonth) = c("Month", "Total Runs", "Miles", "Time", "Pace")#, "MPH", "Calories")

# names(groupby_weekday) = c("Weekday", "Total Runs", "Distance", "Time", "Pace", "Miles Per Run", "MPH", "Calories")

kable(groupby_yearmonth, format = "html", align = "l") %>%
  kable_styling(bootstrap_options = c("hover", "responsive"))
```

***

# Weekday Stats

```{r echo = FALSE}
groupby_weekday = running %>%
  group_by(Weekday) %>%
  summarise(Total_Runs = sum(RunDistance > 0),
            
            Distance = sum(RunDistance),
            
            Time = paste(ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60)),
                         
                         ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60)),
                         
                         ifelse(test = sum(RunSeconds) %% 60 <= 9,
                                yes = paste("0", sum(RunSeconds) %% 60, sep = ""),
                                no = as.character(sum(RunSeconds) %% 60)), sep = ":"),
            
            Pace = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %/% 60, ifelse(test = (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60 <= 9,
                          yes = paste("0", (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60, sep = ""),
                          no = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60)), sep = ":"))
            
            # Miles_Per_Run = floor(sum(RunDistance) * 100 / sum(RunDistance > 0)) / 100,
            
            #MPH = floor(sum(RunDistance) / (((((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60) * 60 * 60 + ((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60) * 60 + sum(RunSeconds) %% 60)) / (60 * 60)) * 1000) / 1000,
            
            #Calories = sum(RunCalories)
            #)

names(groupby_weekday) = c("Weekday", "Total Runs", "Miles", "Time", "Pace")#, "MPH", "Calories")

# names(groupby_weekday) = c("Weekday", "Total Runs", "Distance", "Time", "Pace", "Miles Per Run", "MPH", "Calories")

kable(groupby_weekday, format = "html", align = "l") %>%
  kable_styling(bootstrap_options = c("hover", "responsive"))
```












```{r echo = FALSE, eval = FALSE}
location = running %>%
  group_by(Location) %>%
  summarise(Distance = sum(RunDistance),
            Time = sum(RunMinutes))

location = location[order(location$Distance, decreasing = TRUE), ] %>%
  head()
```

















