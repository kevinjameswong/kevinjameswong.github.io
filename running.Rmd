---
title: "Kevin Wong - Running Data"
output:
  html_document:
    toc: yes
---

```{r echo = FALSE, warning = FALSE, message = FALSE}
library(knitr)
library(kableExtra)
library(tidyverse)
library(stringr)
library(ggplot2)
Start_Date = as.Date("1/28/2018", format = "%m/%d/%Y")
```

```{r echo = FALSE}
Update_Date = as.Date("5/12/2019", format = "%m/%d/%Y")

read_data = read.csv(file = "~/Documents/Kevin Stuff/Not Work/website/Website Files/more website files/Running_5_12_2019.csv", skip = 1)
```

***

```{r echo = FALSE}
read_data = read_data[c(1:(Update_Date - Start_Date) - 1), ]

running = read_data[, c(1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 14, 18, 19, 25)]

names(running) = c("Location", "Weekday_Read", "Month_Number_Read", "Day Number", "Date", "Run Calories", "Run Distance", "Run Minutes", "Run Seconds", "Walk Calories", "Walk Distance", "Walk Minutes", "Walk Seconds", "StartTime")

running$DayNumber    = running$`Day Number`    %>% as.character() %>% as.integer()
running$RunCalories  = running$`Run Calories`  %>% as.character() %>% as.integer()
running$RunDistance  = running$`Run Distance`  %>% as.character() %>% as.numeric()
running$RunMinutes   = running$`Run Minutes`   %>% as.character() %>% as.integer()
running$RunSeconds   = running$`Run Seconds`   %>% as.character() %>% as.integer()
running$WalkCalories = running$`Walk Calories` %>% as.character() %>% as.integer()
running$WalkDistance = running$`Walk Distance` %>% as.character() %>% as.numeric()
running$WalkMinutes  = running$`Walk Minutes`  %>% as.character() %>% as.integer()
running$WalkSeconds  = running$`Walk Seconds`  %>% as.character() %>% as.integer()
running = running[ , c(1, 2, 3, 5, 14:23)]

running$Month = factor(running$Month_Number_Read)
levels(running$Month) = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December", "Total")

running$Year = factor(x = as.factor(paste("20", (str_sub(running$Date, start = 7, end = 8)), sep = "")),
                      levels = c(2018, 2019, "Total"))

running$Weekday = factor(x = running$Weekday_Read,
                         levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday", "Total"))

running = select(running, - Weekday_Read, - Month_Number_Read)
```

```{r echo = FALSE}
total_row = c("Total",
              sum(running$RunDistance > 0),
              sum(running$RunDistance),
              "ok",
              "pace")
```

<script>
function myFunction1() {
  var x = document.getElementById("myDIV1");
  if (x.style.display === "block") {
    x.style.display = "none";
  } else {
    x.style.display = "block";
  }
}

function myFunction2() {
  var x = document.getElementById("myDIV2");
  if (x.style.display === "block") {
    x.style.display = "none";
  } else {
    x.style.display = "block";
  }
}

function myFunction3() {
  var x = document.getElementById("myDIV3");
  if (x.style.display === "block") {
    x.style.display = "none";
  } else {
    x.style.display = "block";
  }
}
</script>

<style type="text/css">

td, tr {
   font-family: "Times New Roman";
   font-size: 20px;
}

body, p {
   font-family: "Times New Roman";
   font-size: 18px;
}

</style>

<h1>Kevin's Running Data</h1>

Last updated: `r paste(levels(running$Month)[str_extract(string = Update_Date, pattern = "-[0-9]{2}") %>% str_extract(pattern = "[0-9]{2}") %>% as.numeric()], " ", str_extract(string = Update_Date, pattern = "-[0-9]{2}-[0-9]{2}") %>% str_extract(pattern = "[0-9]{1}-[0-9]{2}") %>% str_extract(pattern = "[0-9]{2}") %>% as.numeric(), ", ", str_extract(string = Update_Date, pattern = "[0-9]{4}") %>% as.numeric(), sep = "")`

```{r echo = FALSE, eval = FALSE}
levels(running$Month) = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December", "Total")

cp = str_extract(string = Start_Date, pattern = "[0-9]{4}") %>% as.integer()
pp = str_extract(string = Update_Date, pattern = "[0-9]{4}") %>% as.integer()


ppp = str_extract(string = Update_Date, pattern = "-[0-9]{2}") %>% str_extract(pattern = "[0-9]{2}") %>% as.integer()

for (i in 1:((pp - cp) * 12 + ppp)) {
  l[i] = rep(Update_Months)
}
l
Update_Months
```

***

I enjoy running in my freetime! I have been tracking my jogging stats since January 31, 2018. Over the past `r length(running$RunDistance)` days, I have jogged `r sum(running$RunDistance)` miles across `r sum(running$RunDistance > 0)` different runs.

```{r echo = FALSE, eval = FALSE}
HM = c("Illinois Half Marathon",
          "Distance",
          "April 27, 2019",
          "1:43:29",
          "7:54",
          "364/3098",
          "275/1430",
          "36/193")
names(HM) = c("Event", "13.1 Miles", "Date", "Time", "Pace", "Rank", "Rank (Males)", "Rank (Males 20-24)")
HM = as.data.frame(HM)
kable(x = HM, format = "html", align = "lrrrrrrrrrrrrrr") %>%
  kable_styling(bootstrap_options = c("hover", "responsive")) %>%
  scroll_box(width = "100%", height = "100%")
```


*** 

# Yearly Stats

```{r echo = FALSE}
groupby_year = running %>%
  group_by(Year) %>%
  summarise(Total_Runs = sum(RunDistance > 0),
            
            Distance = sum(RunDistance),
            
            Time = paste(ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60)),
                         
                         ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60)),
                         
                         ifelse(test = sum(RunSeconds) %% 60 <= 9,
                                yes = paste("0", sum(RunSeconds) %% 60, sep = ""),
                                no = as.character(sum(RunSeconds) %% 60)), sep = ":"),
            
            Pace = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %/% 60, ifelse(test = (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60 <= 9,
                          yes = paste("0", (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60, sep = ""),
                          no = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60)), sep = ":"))

# groupby_year = rbind(groupby_year, total_row)

names(groupby_year) = c("Year", "Total Runs", "Miles", "Time", "Pace")

groupby_year = groupby_year[order(groupby_year$Year), ]

kable(groupby_year, format = "html", align = "lrrrr") %>%
  kable_styling(bootstrap_options = c("hover", "responsive"))# %>%
  #row_spec(row = nrow(groupby_year), bold = TRUE, font_size = 21)
```

```{r echo = FALSE}
ggplot(data = groupby_year, aes(x = Year, y = Miles)) +
  geom_bar(stat = "identity", fill = "darkblue") +
  geom_text(aes(label = groupby_year$Miles), vjust = 1.6, color = "white", size = 5) +
  ggtitle("Year vs. Miles") +
  theme(plot.title = element_text(hjust = 0.5))
```

<button onclick="myFunction1()" type="button" class="btn btn-primary" data-toggle="collapse" data-target="#demo"> Click to Show Advanced Yearly Stats </button>

<div id="myDIV1" class="collapse">  

<br />

<h3>Advanced Yearly Stats</h3>

```{r echo = FALSE}
groupby_year = running %>%
  group_by(Year) %>%
  summarise(Total_Runs = sum(RunDistance > 0),
            
            Days_Off = sum(RunDistance == 0),
            
            Distance = sum(RunDistance),
            
            Time = paste(ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60)),
                         
                         ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60)),
                         
                         ifelse(test = sum(RunSeconds) %% 60 <= 9,
                                yes = paste("0", sum(RunSeconds) %% 60, sep = ""),
                                no = as.character(sum(RunSeconds) %% 60)), sep = ":"),
            
            Pace = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %/% 60, ifelse(test = (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60 <= 9,
                          yes = paste("0", (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60, sep = ""),
                          no = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60)), sep = ":"),
            
            Miles_Per_Run = floor(sum(RunDistance) * 100 / sum(RunDistance > 0)) / 100,
            
            Miles_Per_Day = floor(sum(RunDistance) * 100 / sum(RunDistance >= 0)) / 100,
            
            Yearly_Mile_Rate = floor(sum(RunDistance) * 100 * 365 / sum(RunDistance >= 0)) / 100,
            
            MPH = floor(sum(RunDistance) / (((((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60) * 60 * 60 + ((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60) * 60 + sum(RunSeconds) %% 60)) / (60 * 60)) * 1000) / 1000,
            
            Calories = sum(RunCalories)
            )

names(groupby_year) = c("Year", "Total Runs", "Days Off", "Miles", "Time", "Pace", "Miles Per Run", "Miles Per Day", "Yearly Mile Rate", "MPH", "Total Calories Burned")

kable(x = groupby_year, format = "html", align = "lrrrrrrrrrrrrrr") %>%
  kable_styling(bootstrap_options = c("hover", "responsive")) %>%
  scroll_box(width = "100%", height = "100%")
```

</div>


***

# Monthly Stats

```{r echo = FALSE}
groupby_yearmonth = running %>%
  group_by(Year, Month) %>%
  summarise(Total_Runs = sum(RunDistance > 0),
            
            Distance = sum(RunDistance),
            
            Time = paste(ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60)),
                         
                         ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60)),
                         
                         ifelse(test = sum(RunSeconds) %% 60 <= 9,
                                yes = paste("0", sum(RunSeconds) %% 60, sep = ""),
                                no = as.character(sum(RunSeconds) %% 60)), sep = ":"),
            
            Pace = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %/% 60, ifelse(test = (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60 <= 9,
                          yes = paste("0", (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60, sep = ""),
                          no = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60)), sep = ":"))

groupby_yearmonth$yearmonth = paste(groupby_yearmonth$Month, groupby_yearmonth$Year, sep = " ")
groupby_yearmonth = select(as.data.frame(select(groupby_yearmonth, - Month)), - Year)
groupby_yearmonth = groupby_yearmonth[, c(ncol(groupby_yearmonth), 1:ncol(groupby_yearmonth) - 1)]

# groupby_yearmonth = rbind(groupby_yearmonth, total_row)

names(groupby_yearmonth) = c("Month", "Total Runs", "Miles", "Time", "Pace")

kable(groupby_yearmonth, format = "html", align = "lrrrr") %>%
  kable_styling(bootstrap_options = c("hover", "responsive")) #%>%
  #row_spec(row = nrow(groupby_yearmonth), bold = TRUE, font_size = 21)
```

```{r echo = FALSE, eval = FALSE}
ggplot(data = groupby_yearmonth, aes(x = Month, y = Miles %>% as.numeric())) +
  geom_bar(stat = "identity", fill = "darkblue") +
  geom_text(aes(label = groupby_yearmonth$Miles), vjust = 1.6, color = "white", size = 2) +
  ggtitle("Month vs. Miles") +
  theme(plot.title = element_text(hjust = 0.5))
```

<button onclick="myFunction2()" type="button" class="btn btn-primary" data-toggle="collapse" data-target="#demo"> Click to Show Advanced Monthly Stats </button>

<div id="myDIV2" class="collapse">  

<br />

<h3>Advanced Monthly Stats</h3>

```{r echo = FALSE}
groupby_yearmonth = running %>%
  group_by(Year, Month) %>%
  summarise(Total_Runs = sum(RunDistance > 0),
            
            Days_Off = sum(RunDistance == 0),
            
            Distance = sum(RunDistance),
            
            Time = paste(ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60)),
                         
                         ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60)),
                         
                         ifelse(test = sum(RunSeconds) %% 60 <= 9,
                                yes = paste("0", sum(RunSeconds) %% 60, sep = ""),
                                no = as.character(sum(RunSeconds) %% 60)), sep = ":"),
            
            Pace = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %/% 60, ifelse(test = (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60 <= 9,
                          yes = paste("0", (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60, sep = ""),
                          no = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60)), sep = ":"),
            
            Miles_Per_Run = floor(sum(RunDistance) * 100 / sum(RunDistance > 0)) / 100,
            
            Miles_Per_Day = floor(sum(RunDistance) * 100 / sum(RunDistance >= 0)) / 100,
            
            Yearly_Mile_Rate = floor(sum(RunDistance) * 100 * 365 / sum(RunDistance >= 0)) / 100,
            
            MPH = floor(sum(RunDistance) / (((((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60) * 60 * 60 + ((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60) * 60 + sum(RunSeconds) %% 60)) / (60 * 60)) * 1000) / 1000,
            
            Calories = sum(RunCalories)
            )

groupby_yearmonth$yearmonth = paste(groupby_yearmonth$Month, groupby_yearmonth$Year, sep = " ")
groupby_yearmonth = select(as.data.frame(select(groupby_yearmonth, - Month)), - Year)
groupby_yearmonth = groupby_yearmonth[, c(ncol(groupby_yearmonth), 1:(ncol(groupby_yearmonth) - 1))]

names(groupby_yearmonth) = c("Month", "Total Runs", "Days Off", "Miles", "Time", "Pace", "Miles Per Run", "Miles Per Day", "Yearly Mile Rate", "MPH", "Total Calories Burned")

kable(x = groupby_yearmonth, format = "html", align = "lrrrrrrrrrrrrrr") %>%
  kable_styling(bootstrap_options = c("hover", "responsive")) %>%
  scroll_box(width = "100%", height = "100%")
```

</div>

***

# Weekday Stats

```{r echo = FALSE}
groupby_weekday = running %>%
  group_by(Weekday) %>%
  summarise(Total_Runs = sum(RunDistance > 0),
            
            Distance = sum(RunDistance),
            
            Time = paste(ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60)),
                         
                         ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60)),
                         
                         ifelse(test = sum(RunSeconds) %% 60 <= 9,
                                yes = paste("0", sum(RunSeconds) %% 60, sep = ""),
                                no = as.character(sum(RunSeconds) %% 60)), sep = ":"),
            
            Pace = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %/% 60, ifelse(test = (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60 <= 9,
                          yes = paste("0", (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60, sep = ""),
                          no = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60)), sep = ":"))
            
            # Miles_Per_Run = floor(sum(RunDistance) * 100 / sum(RunDistance > 0)) / 100,
            
            #MPH = floor(sum(RunDistance) / (((((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60) * 60 * 60 + ((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60) * 60 + sum(RunSeconds) %% 60)) / (60 * 60)) * 1000) / 1000,
            
            #Calories = sum(RunCalories)
            #)

# groupby_weekday = rbind(groupby_weekday, total_row)

names(groupby_weekday) = c("Weekday", "Total Runs", "Miles", "Time", "Pace")#, "MPH", "Calories")

# names(groupby_weekday) = c("Weekday", "Total Runs", "Distance", "Time", "Pace", "Miles Per Run", "MPH", "Calories")

kable(groupby_weekday, format = "html", align = "lrrrr") %>%
  kable_styling(bootstrap_options = c("hover", "responsive"))# %>%
  #row_spec(row = nrow(groupby_weekday), bold = TRUE, font_size = 21)
```

```{r echo = FALSE}
ggplot(data = groupby_weekday, aes(x = Weekday, y = Miles)) +
  geom_bar(stat = "identity", fill = "darkblue") +
  geom_text(aes(label = groupby_weekday$Miles), vjust = 1.6, color = "white", size = 5) +
  ggtitle("Weekday vs. Miles") +
  theme(plot.title = element_text(hjust = 0.5))
```

<button onclick="myFunction3()" type="button" class="btn btn-primary" data-toggle="collapse" data-target="#demo"> Click to Show Advanced Weekday Stats </button>

<div id="myDIV3" class="collapse">  

<br />

<h3>Advanced Weekday Stats</h3>

```{r echo = FALSE}
groupby_weekday = running %>%
  group_by(Weekday) %>%
  summarise(Total_Runs = sum(RunDistance > 0),
            
            Days_Off = sum(RunDistance == 0),
            
            Distance = sum(RunDistance),
            
            Time = paste(ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60)),
                         
                         ifelse(test = (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60 <= 9,
                                yes = paste("0", (sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60, sep = ""),
                                no = as.character((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60)),
                         
                         ifelse(test = sum(RunSeconds) %% 60 <= 9,
                                yes = paste("0", sum(RunSeconds) %% 60, sep = ""),
                                no = as.character(sum(RunSeconds) %% 60)), sep = ":"),
            
            Pace = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %/% 60, ifelse(test = (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60 <= 9,
                          yes = paste("0", (ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60, sep = ""),
                          no = paste((ceiling((sum(RunMinutes) * 60 + sum(RunSeconds)) / sum(RunDistance))) %% 60)), sep = ":"),
            
            Miles_Per_Run = floor(sum(RunDistance) * 100 / sum(RunDistance > 0)) / 100,
            
            Miles_Per_Day = floor(sum(RunDistance) * 100 / sum(RunDistance >= 0)) / 100,
            
            Yearly_Mile_Rate = floor(sum(RunDistance) * 100 * 365 / sum(RunDistance >= 0)) / 100,
            
            MPH = floor(sum(RunDistance) / (((((sum(RunMinutes) + sum(RunSeconds) %/% 60) %/% 60) * 60 * 60 + ((sum(RunMinutes) + sum(RunSeconds) %/% 60) %% 60) * 60 + sum(RunSeconds) %% 60)) / (60 * 60)) * 1000) / 1000,
            
            Calories = sum(RunCalories)
            )

names(groupby_weekday) = c("Weekday", "Total Runs", "Days Off", "Miles", "Time", "Pace", "Miles Per Run", "Miles Per Day", "Yearly Mile Rate", "MPH", "Total Calories Burned")

kable(x = groupby_weekday, format = "html", align = "lrrrrrrrrrrrrrr") %>%
  kable_styling(bootstrap_options = c("hover", "responsive")) %>%
  scroll_box(width = "100%", height = "100%")
```

</div>





```{r echo = FALSE, eval = FALSE}
location = running %>%
  group_by(Location) %>%
  summarise(Distance = sum(RunDistance),
            Time = sum(RunMinutes))

location = location[order(location$Distance, decreasing = TRUE), ] %>%
  head()
```















