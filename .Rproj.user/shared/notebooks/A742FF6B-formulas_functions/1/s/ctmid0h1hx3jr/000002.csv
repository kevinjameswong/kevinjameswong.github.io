"0","kevin_ci_2_sample_prop = function(p_hat_A, p_hat_B, confidence_level, n_A, n_B, ...) {"
"0","  p_hat_A = as.numeric(data.frame(unlist(as.list(match.call())[c(""p_hat_A"", ""mean_A"", ""sample_proportion_A"")])[1]))"
"0","  p_hat_B = as.numeric(data.frame(unlist(as.list(match.call())[c(""p_hat_B"", ""mean_B"", ""sample_proportion_B"")])[1]))"
"0","  "
"0","  p1_minus_p2 = p_hat_A - p_hat_B"
"0","  if (confidence_level > 100) {"
"0","    return(message (""ERROR: Check confidence level!""))"
"0","  }"
"0","  if (confidence_level < 1) {"
"0","    confidence_level = confidence_level * 100"
"0","  }"
"0","  alpha = 1 - confidence_level / 100"
"0","  crit = - qnorm(p = alpha / 2, mean = 0, sd = 1)"
"0","  "
"0","  standard_error = sqrt((p_hat_A * (1 - p_hat_A) / n_A) + (p_hat_B * (1 - p_hat_B) / n_B))"
"0","  margin_of_error = crit * standard_error"
"0","  lower = p1_minus_p2 - margin_of_error"
"0","  upper = p1_minus_p2 + margin_of_error"
"0","  results = c(lower, upper)"
"0","  names(results) = c(""Lower"", ""Upper"")"
"0","  return(results)"
"0","}"
