"0","kevin_ci_mean = function(x_bar, sd, confidence_level, n, type, ...) {"
"0","  x_bar = as.numeric(data.frame(unlist(as.list(match.call())[c(""x_bar"", ""mean"", ""xbar"")])[1]))"
"0","  sd = as.numeric(data.frame(unlist(as.list(match.call())[c(""sd"", ""sigma"")])[1]))"
"0","  average = as.numeric(data.frame(unlist(as.list(match.call())[c(""average"", ""avg"")])[1]))"
"0","  standard_error = sd / sqrt(n)"
"0","  if (confidence_level > 100) {"
"0","    return(message (""ERROR: Check confidence level!""))"
"0","  }"
"0","  if (confidence_level < 1) {"
"0","    confidence_level = confidence_level * 100"
"0","  }"
"0","  alpha = 1 - confidence_level / 100"
"0","  if (type == ""Z"" | type == ""z"") {"
"0","    crit = - qnorm(p = alpha / 2, mean = 0, sd = 1)"
"0","  }"
"0","  else if (type == ""T"" | type == ""t"") {"
"0","    crit = - qt(p = alpha / 2, df = n - 1)"
"0","  }"
"0","  else {"
"0","    return(message(""Need type to be either t or z!""))"
"0","  }"
"0","  margin_of_error = crit * standard_error"
"0","  lower = x_bar - margin_of_error"
"0","  upper = x_bar + margin_of_error"
"0","  results = c(lower, upper)"
"0","  names(results) = c(""Lower"", ""Upper"")"
"0","  return(results)"
"0","}"
